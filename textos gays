
categoria = request.args.get('categoria')
disponibilidade = request.args.get('disponibilidade')


# Filtros dinâmicos (já existentes)
if nota_min:
    query += " AND nota >= ?"
    parametros.append(nota_min)
if nota_max:
    query += " AND nota <= ?"
    parametros.append(nota_max)
if paginas_min:
    query += " AND paginas >= ?"
    parametros.append(paginas_min)
if paginas_max:
    query += " AND paginas <= ?"
    parametros.append(paginas_max)
if idioma:
    query += " AND LOWER(idioma) = ?"
    parametros.append(idioma.lower())

# >>>>> ADICIONE ISTO <<<<<
if categoria:
    query += " AND categoria = ?"
    parametros.append(categoria)
if disponibilidade == 'disponivel':
    query += " AND quantidade > 0"
elif disponibilidade == 'indisponivel':
    query += " AND quantidade <= 0"
